<style>
  .minipost.vcomp {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    /* opacity: 1; */
    /* transition: all 2s; */
  }

  /* .minipost.vcomp.active {
    opacity: 1;
  } */

  .minipost.vcomp > .postbody {
    border-collapse: collapse;
    position: relative;
    width: 100%;
    height: 100%;
  }

  .minipost.vcomp > .postbody > tbody > tr > td {
    position: relative;
    height: 50%;
    border: 3px solid white;
    border-right: 0;
  }

  .minipost.vcomp > .postbody > tbody > tr > td > img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    object-fit: cover;
    transition: all 2s;
  }
</style>

<script type='text/x-template' id='minipost-template'>
  <!-- <div class='minipost vcomp' :class='[status<=0 ? "active" : "", post_type]'> -->
  <div class='minipost vcomp'>

    <table class='postbody' v-if='is_postvoteab' @click='$emit("open_posts", post[0].id)'>
      <tbody>
        <tr><td><img :src='post[0].pix_a' @load='imgloaded' v-if='post[0]'></td></tr>
        <tr><td><img :src='post[0].pix_b' @load='imgloaded' v-if='post[0]'></td></tr>
      </tbody>
    </table>

    <table class='postbody' v-else>
      <tbody>
        <tr><td><img :src='post[0].pix' @load='imgloaded' v-if='post[0]' @click='$emit("open_posts", post[0].id)'></td></tr>
        <tr><td><img :src='post[1].pix' @load='imgloaded' v-if='post[1]' @click='$emit("open_posts", post[1].id)'></td></tr>
      </tbody>
    </table>

  </div>
</script>

<script>
  Vue.component('minipost', {
    template: '#minipost-template',
    delimiters: ['[[', ']]'],
    props: [ 'post' ],
    data: function() {
      return {
        status: undefined
      }
    },

    created: function() {
      // if (this.is_postqa) {
      //   this.status = 1;
      //
      // } else if (this.is_postvoteab) {
      //   this.status = 2;
      //
      // } else if (this.is_postvoteox) {
      //   this.status = 1;
      // }
    },

    computed: {
      post_type: function() {
        if (this.post[0]) {
          return this.post[0].type
        }
      },
      //
      // is_postqa: function() {
      //   return this.post_type == 'postqa'
      // },
      //
      // is_postvoteox: function() {
      //   return this.post_type == 'postvoteox'
      // },
      //
      is_postvoteab: function() {
        return this.post_type == 'postvoteab'
      },
    },

    methods: {
      imgloaded: function(event) {
        event.target.style.opacity = 1;
        // console.log(event.target)
        // this.status -= 1;
      }
    }
  });
</script>
